<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Password Checker</title>
</head>
<body>
	<style type="text/css">

		body {
			font-family: monospace;
		}

		.result-string {
			font-size: 16px;
		}
		
		.result-label {
			text-decoration: underline;
			font-weight: 600;
		}

		.time-string {
			font-size: 14px;
		}

		.suggestion {
			font-size: 14px;
		}

		.strength-weak {
			color: #dd1010;
		}

		.strength-low {
			color: #db7010;
		}

		.strength-good {
			color: #1080dd;
		}

		.strength-strong {
			color: #30b010;
		}

    </style>

	<h1>Password Checker</h1>

	<input type="text" name="password" size="32" placeholder="password" id="password-input">

	<p class="result-string"><span class="result-label">Password Strength</span>: <span id="strength">...</span></p>
	<p class="result-string"><span class="result-label">Estimated Time to Crack</span>:</p>
	<ul>
		<li class="time-string"><span class="time-label">Offline (Fast Hashing)</span>: <span id="time-est1">...</span></li>
		<li class="time-string"><span class="time-label">Offline (Slow Hashing)</span>: <span id="time-est2">...</span></li>
		<li class="time-string"><span class="time-label">Online (No Throttling)</span>: <span id="time-est3">...</span></li>
		<li class="time-string"><span class="time-label">Online (Throttling)</span>: <span id="time-est4">...</span></li>
	</ul>
	<p class="result-string"><span class="result-label">Suggestions</span>:</p>
	<ul id="suggestions">
		<li class="suggestion">...</li>
	</ul>

	<script
    	src="https://code.jquery.com/jquery-3.2.1.js"
    	integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE="
    	crossorigin="anonymous">
  	</script>
	<script
		type="text/javascript"
		src="./assets/javascript/zxcvbn-4.4.2/dist/zxcvbn.js">
	</script>
	<script>
		var input = $("input[name=password]");
		var strength = $("#strength");
		var timeEst1 = $("#time-est1");
		var timeEst2 = $("#time-est2");
		var timeEst3 = $("#time-est3");
		var timeEst4 = $("#time-est4");
		var suggestions = $("#suggestions");

		function score(num) {
			return num === 0 ? "Weak" : num === 1 ? "Low" : num === 2 ? "Good" : "Strong";
		}

		input.on("input", function() {
			if (input.val() === "" || input.val === null) {
				strength.text("...");
				strength.removeClass("strength-weak strength-low strength-good strength-strong");

				timeEst1.text("...");
				timeEst2.text("...");
				timeEst3.text("...");
				timeEst4.text("...");

				suggestions.html('<li class="suggestion">...</li>');
			} else {
				var result = zxcvbn(input.val());
				strength.text(score(result.score));
				strength.removeClass("strength-weak, strength-low strength-good strength-strong");
				strength.addClass((result.score === 0 ? "strength-weak" : result.score === 1 ? "strength-low" : result.score === 2 ? "strength-good": "strength-strong"));
				
				timeEst1.text(result.crack_times_display.offline_fast_hashing_1e10_per_second);
				timeEst2.text(result.crack_times_display.offline_slow_hashing_1e4_per_second);
				timeEst3.text(result.crack_times_display.online_no_throttling_10_per_second);
				timeEst4.text(result.crack_times_display.online_throttling_100_per_hour);

				if (result.feedback.suggestions.length > 0) {
					suggestions.html("");
					for (var i = 0; i < result.feedback.suggestions.length; i++) {
						var suggestion = $("<li>");
						suggestion.addClass("suggestion");
						suggestion.text(result.feedback.suggestions[i]);
						suggestions.append(suggestion);
					}
				} else {
					suggestions.html('<li class="suggestion">...</li>');
				}
			}
		});
	</script>	
</body>
</html>